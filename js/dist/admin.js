/*! For license information please see admin.js.LICENSE.txt */
(()=>{var t={24:(t,e,r)=>{var n=r(163),o=r(110),a=r(996),s=r(312),i=r(166),c=r(766),u=r(760);function p(){"use strict";var e=o(),r=e.m(p),l=(Object.getPrototypeOf?Object.getPrototypeOf(r):r.__proto__).constructor;function f(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===l||"GeneratorFunction"===(e.displayName||e.name))}var h={throw:1,return:2,break:3,continue:3};function d(t){var e,r;return function(n){e||(e={stop:function(){return r(n.a,2)},catch:function(){return n.v},abrupt:function(t,e){return r(n.a,h[t],e)},delegateYield:function(t,o,a){return e.resultName=o,r(n.d,u(t),a)},finish:function(t){return r(n.f,t)}},r=function(t,r,o){n.p=e.prev,n.n=e.next;try{return t(r,o)}finally{e.next=n.n}}),e.resultName&&(e[e.resultName]=n.v,e.resultName=void 0),e.sent=n.v,e.next=n.n;try{return t.call(this,e)}finally{n.p=e.prev,n.n=e.next}}}return(t.exports=p=function(){return{wrap:function(t,r,n,o){return e.w(d(t),r,n,o&&o.reverse())},isGeneratorFunction:f,mark:e.m,awrap:function(t,e){return new n(t,e)},AsyncIterator:i,async:function(t,e,r,n,o){return(f(e)?s:a)(d(t),e,r,n,o)},keys:c,values:u}},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=p,t.exports.__esModule=!0,t.exports.default=t.exports},110:(t,e,r)=>{var n=r(397);function o(){var e,r,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",i=a.toStringTag||"@@toStringTag";function c(t,o,a,s){var i=o&&o.prototype instanceof p?o:p,c=Object.create(i.prototype);return n(c,"_invoke",function(t,n,o){var a,s,i,c=0,p=o||[],l=!1,f={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,r){return a=t,s=0,i=e,f.n=r,u}};function h(t,n){for(s=t,i=n,r=0;!l&&c&&!o&&r<p.length;r++){var o,a=p[r],h=f.p,d=a[2];t>3?(o=d===n)&&(i=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=e):a[0]<=h&&((o=t<2&&h<a[1])?(s=0,f.v=n,f.n=a[1]):h<d&&(o=t<3||a[0]>n||n>d)&&(a[4]=t,a[5]=n,f.n=d,s=0))}if(o||t>1)return u;throw l=!0,n}return function(o,p,d){if(c>1)throw TypeError("Generator is already running");for(l&&1===p&&h(p,d),s=p,i=d;(r=s<2?e:i)||!l;){a||(s?s<3?(s>1&&(f.n=-1),h(s,i)):f.n=i:f.v=i);try{if(c=2,a){if(s||(o="next"),r=a[o]){if(!(r=r.call(a,i)))throw TypeError("iterator result is not an object");if(!r.done)return r;i=r.value,s<2&&(s=0)}else 1===s&&(r=a.return)&&r.call(a),s<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=e}else if((r=(l=f.n<0)?i:t.call(n,f))!==u)break}catch(t){a=e,s=1,i=t}finally{c=1}}return{value:r,done:l}}}(t,a,s),!0),c}var u={};function p(){}function l(){}function f(){}r=Object.getPrototypeOf;var h=[][s]?r(r([][s]())):(n(r={},s,function(){return this}),r),d=f.prototype=p.prototype=Object.create(h);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,n(t,i,"GeneratorFunction")),t.prototype=Object.create(d),t}return l.prototype=f,n(d,"constructor",f),n(f,"constructor",l),l.displayName="GeneratorFunction",n(f,i,"GeneratorFunction"),n(d),n(d,i,"Generator"),n(d,s,function(){return this}),n(d,"toString",function(){return"[object Generator]"}),(t.exports=o=function(){return{w:c,m}},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=o,t.exports.__esModule=!0,t.exports.default=t.exports},163:t=>{t.exports=function(t,e){this.v=t,this.k=e},t.exports.__esModule=!0,t.exports.default=t.exports},166:(t,e,r)=>{var n=r(163),o=r(397);t.exports=function t(e,r){function a(t,o,s,i){try{var c=e[t](o),u=c.value;return u instanceof n?r.resolve(u.v).then(function(t){a("next",t,s,i)},function(t){a("throw",t,s,i)}):r.resolve(u).then(function(t){c.value=t,s(c)},function(t){return a("throw",t,s,i)})}catch(t){i(t)}}var s;this.next||(o(t.prototype),o(t.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),o(this,"_invoke",function(t,e,n){function o(){return new r(function(e,r){a(t,n,e,r)})}return s=s?s.then(o,o):o()},!0)},t.exports.__esModule=!0,t.exports.default=t.exports},183:(t,e,r)=>{var n=r(24)();t.exports=n;try{regeneratorRuntime=n}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},312:(t,e,r)=>{var n=r(110),o=r(166);t.exports=function(t,e,r,a,s){return new o(n().w(t,e,r,a),s||Promise)},t.exports.__esModule=!0,t.exports.default=t.exports},397:t=>{function e(r,n,o,a){var s=Object.defineProperty;try{s({},"",{})}catch(r){s=0}t.exports=e=function(t,r,n,o){function a(r,n){e(t,r,function(t){return this._invoke(r,n,t)})}r?s?s(t,r,{value:n,enumerable:!o,configurable:!o,writable:!o}):t[r]=n:(a("next",0),a("throw",1),a("return",2))},t.exports.__esModule=!0,t.exports.default=t.exports,e(r,n,o,a)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},735:t=>{function e(r){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},760:(t,e,r)=>{var n=r(735).default;t.exports=function(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}throw new TypeError(n(t)+" is not iterable")},t.exports.__esModule=!0,t.exports.default=t.exports},766:t=>{t.exports=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},t.exports.__esModule=!0,t.exports.default=t.exports},996:(t,e,r)=>{var n=r(312);t.exports=function(t,e,r,o,a){var s=n(t,e,r,o,a);return s.next().then(function(t){return t.done?t.value:s.next()})},t.exports.__esModule=!0,t.exports.default=t.exports}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var a=e[n]={exports:{}};return t[n](a,a.exports,r),a.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";const t=flarum.core.compat["admin/app"];var e=r.n(t);function n(){return n=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},n.apply(null,arguments)}function o(t,e){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},o(t,e)}function a(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,o(t,e)}const s=flarum.core.compat["admin/components/ExtensionPage"];var i=r.n(s);function c(t,e,r,n,o,a,s){try{var i=t[a](s),c=i.value}catch(t){return void r(t)}i.done?e(c):Promise.resolve(c).then(n,o)}function u(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var a=t.apply(e,r);function s(t){c(a,n,o,s,i,"next",t)}function i(t){c(a,n,o,s,i,"throw",t)}s(void 0)})}}var p=r(183),l=r.n(p);const f=flarum.core.compat["common/Component"];var h=r.n(f);const d=flarum.core.compat["common/app"];var v=r.n(d),y=function(){function t(t,e,r){void 0===r&&(r=null),this.settings=t,this.callback=e,this.errorCallback=r||function(t){v().alerts.show(t)},this.widgetId=null,this.type=this.settings["fof-recaptcha.type"]}var e=t.prototype;return e.render=function(t){var e=this;this.widgetId=grecaptcha.render(t,{sitekey:this.settings["fof-recaptcha.credentials.site"],theme:Number(this.settings.theme_dark_mode)?"dark":"light",type:this.type,size:this.isInvisible()?"invisible":"normal",tabindex:this.isInvisible()?-1:null,callback:this.callback,"error-callback":function(){var t={type:"error",content:v().translator.trans("fof-recaptcha.forum.error")};e.errorCallback(t)}})},e.getResponse=function(){return grecaptcha.getResponse(this.widgetId)},e.execute=function(){return grecaptcha.execute(this.widgetId)},e.reset=function(){return grecaptcha.reset(this.widgetId)},e.isInvisible=function(){return"invisible"===this.type},t}();const b=function(){function t(t){return function(e){return new Promise(function(r,n){var o=document.createElement(t),a="body",s="src";switch(o.onload=function(){r(e)},o.onerror=function(){n(e)},t){case"script":o.async=!0;break;case"link":o.type="text/css",o.rel="stylesheet",s="href",a="head"}o[s]=e,document[a].appendChild(o)})}}return{css:t("link"),js:t("script"),img:t("img")}}();var g=function(){var t=u(l().mark(function t(){return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!v().recaptchaLoaded){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,b.js("https://www.recaptcha.net/recaptcha/api.js?hl="+v().translator.getLocale()+"&render=explicit");case 4:v().recaptchaLoaded=!0;case 5:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),x=function(t){function e(){return t.apply(this,arguments)||this}a(e,t);var r=e.prototype;return r.oninit=function(e){t.prototype.oninit.call(this,e)},r.view=function(){return m("div",{className:"Form-group",id:"fof-recaptcha"},m("div",{className:"g-recaptcha"}))},r.oncreate=function(e){var r=this;if(t.prototype.oncreate.call(this,e),g().then(function(){var t=setInterval(function(){window.recaptcha&&(clearInterval(t),r.attrs.state.render(e.dom.querySelector(".g-recaptcha")))},250)}),"invisible"===this.attrs.state.type){var n=e.dom.querySelector("iframe");n&&(n.tabIndex=-1)}},e}(h());const _=flarum.core.compat["common/components/Button"];var w=r.n(_);const k=flarum.core.compat["common/components/Alert"];var O=r.n(k);const S=flarum.core.compat["common/utils/classList"];var j=r.n(S),P=function(t){function r(){for(var e,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).loading=!1,e.alertAttrs=void 0,e}a(r,t);var n=r.prototype;return n.view=function(t){var r;return m("div",{className:"RecaptchaPage-recaptcha"},m("div",{class:"ExtensionPage-permissions-header"},m("div",{class:"container"},m("h2",{className:"ExtensionTitle"},e().translator.trans("fof-recaptcha.admin.test.title")))),m("div",{class:"container"},m("form",{onsubmit:this.onsubmit.bind(this),className:j()("FoFReCaptchaTestForm",(null==(r=this.state)?void 0:r.isInvisible())&&"isInvisible")},m("div",{class:"Form-group Form-group--recaptcha"},m("p",{class:"helpText"},e().translator.trans("fof-recaptcha.admin.test.help_text")),this.alertAttrs&&m(O(),Object.assign({},this.alertAttrs,{dismissible:!1})),this.state&&m(x,{state:this.state})),m("div",{class:"Form-group"},m("div",{class:"ButtonGroup"},m(w(),{className:"Button Button--primary",type:"submit",loading:this.loading},e().translator.trans("fof-recaptcha.admin.test."+(this.state?"submit":"load_test")+"_button")),this.state&&m(w(),{className:"Button",onclick:this.initialize.bind(this)},e().translator.trans("fof-recaptcha.admin.test.reload_button")))),m("div",{class:"Form-group"}))))},n.destroy=function(){this.state=null,this.alertAttrs=null,this.loading=!1,m.redraw.sync()},n.initialize=function(){var t=this;this.destroy();var r=this.attrs.settings||e().data.settings;this.state=new y(r,function(){if(t.state.isInvisible()){var e=new Event("submit");e.isRecaptchaSecondStep=!0,t.onsubmit(e)}},this.onerror)},n.onsubmit=function(){var t=u(l().mark(function t(r){var n;return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),this.state){t.next=3;break}return t.abrupt("return",this.initialize());case 3:if(this.alertAttrs=null,this.loading=!0,m.redraw(),!this.state.isInvisible()||r.isRecaptchaSecondStep){t.next=10;break}return r.preventDefault(),this.state.execute(),t.abrupt("return");case 10:return n={"g-recaptcha-response":this.state.getResponse()},t.prev=11,t.next=14,e().request({method:"POST",url:e().forum.attribute("apiUrl")+"/fof/recaptcha/test",body:n,errorHandler:function(){}});case 14:t.next=19;break;case 16:return t.prev=16,t.t0=t.catch(11),t.abrupt("return",this.onerror(t.t0));case 19:this.loading=!1,this.alertAttrs={type:"success",content:e().translator.trans("fof-recaptcha.admin.test.success_message")},this.state.reset(),m.redraw();case 23:case"end":return t.stop()}},t,this,[[11,16]])}));return function(e){return t.apply(this,arguments)}}(),n.onerror=function(t){var e,r=t.alert||t;this.loading=!1,this.alertAttrs=r,null==(e=this.state)||e.reset(),m.redraw()},r}(h()),I=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e.prototype.sections=function(e){var r=t.prototype.sections.call(this,e),o=n({},this.settings);for(var a in o)o[a]instanceof Function&&(o[a]=o[a].call(this));return r.add("recaptcha",m(P,{settings:o})),r.setPriority("permissions",-1),r},e}(i());e().initializers.add("fof/recaptcha",function(){e().extensionData.for("fof-recaptcha").registerPage(I).registerSetting({setting:"fof-recaptcha.type",label:e().translator.trans("fof-recaptcha.admin.settings.type_label"),help:e().translator.trans("fof-recaptcha.admin.settings.type_help"),options:{checkbox:"Checkbox",invisible:"Invisible"},required:!0,default:"checkbox",type:"select"}).registerSetting({setting:"fof-recaptcha.credentials.site",label:e().translator.trans("fof-recaptcha.admin.settings.site_key_label"),type:"text",required:!0,help:e().translator.trans("fof-recaptcha.admin.settings.help_text",{a:m("a",{href:"https://www.google.com/recaptcha/admin",target:"_blank",rel:"noopener"})})}).registerSetting({setting:"fof-recaptcha.credentials.secret",label:e().translator.trans("fof-recaptcha.admin.settings.secret_key_label"),type:"password",required:!0}).registerSetting({setting:"fof-recaptcha.signup",type:"bool",label:e().translator.trans("fof-recaptcha.admin.settings.signup")}).registerSetting({setting:"fof-recaptcha.signin",type:"bool",label:e().translator.trans("fof-recaptcha.admin.settings.signin")}).registerSetting({setting:"fof-recaptcha.forgot",type:"bool",label:e().translator.trans("fof-recaptcha.admin.settings.forgot")}).registerPermission({permission:"fof-recaptcha.postWithoutCaptcha",label:e().translator.trans("fof-recaptcha.admin.permissions.post_without_captcha"),icon:"fas fa-robot"},"reply")})})(),module.exports={}})();
//# sourceMappingURL=admin.js.map