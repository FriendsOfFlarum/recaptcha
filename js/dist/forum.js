/*! For license information please see forum.js.LICENSE.txt */
(()=>{var t={24:(t,e,r)=>{var o=r(163),n=r(110),a=r(996),c=r(312),i=r(166),u=r(766),s=r(760);function p(){"use strict";var e=n(),r=e.m(p),f=(Object.getPrototypeOf?Object.getPrototypeOf(r):r.__proto__).constructor;function l(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))}var d={throw:1,return:2,break:3,continue:3};function h(t){var e,r;return function(o){e||(e={stop:function(){return r(o.a,2)},catch:function(){return o.v},abrupt:function(t,e){return r(o.a,d[t],e)},delegateYield:function(t,n,a){return e.resultName=n,r(o.d,s(t),a)},finish:function(t){return r(o.f,t)}},r=function(t,r,n){o.p=e.prev,o.n=e.next;try{return t(r,n)}finally{e.next=o.n}}),e.resultName&&(e[e.resultName]=o.v,e.resultName=void 0),e.sent=o.v,e.next=o.n;try{return t.call(this,e)}finally{o.p=e.prev,o.n=e.next}}}return(t.exports=p=function(){return{wrap:function(t,r,o,n){return e.w(h(t),r,o,n&&n.reverse())},isGeneratorFunction:l,mark:e.m,awrap:function(t,e){return new o(t,e)},AsyncIterator:i,async:function(t,e,r,o,n){return(l(e)?c:a)(h(t),e,r,o,n)},keys:u,values:s}},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=p,t.exports.__esModule=!0,t.exports.default=t.exports},110:(t,e,r)=>{var o=r(397);function n(){var e,r,a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",i=a.toStringTag||"@@toStringTag";function u(t,n,a,c){var i=n&&n.prototype instanceof p?n:p,u=Object.create(i.prototype);return o(u,"_invoke",function(t,o,n){var a,c,i,u=0,p=n||[],f=!1,l={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,r){return a=t,c=0,i=e,l.n=r,s}};function d(t,o){for(c=t,i=o,r=0;!f&&u&&!n&&r<p.length;r++){var n,a=p[r],d=l.p,h=a[2];t>3?(n=h===o)&&(i=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=d&&((n=t<2&&d<a[1])?(c=0,l.v=o,l.n=a[1]):d<h&&(n=t<3||a[0]>o||o>h)&&(a[4]=t,a[5]=o,l.n=h,c=0))}if(n||t>1)return s;throw f=!0,o}return function(n,p,h){if(u>1)throw TypeError("Generator is already running");for(f&&1===p&&d(p,h),c=p,i=h;(r=c<2?e:i)||!f;){a||(c?c<3?(c>1&&(l.n=-1),d(c,i)):l.n=i:l.v=i);try{if(u=2,a){if(c||(n="next"),r=a[n]){if(!(r=r.call(a,i)))throw TypeError("iterator result is not an object");if(!r.done)return r;i=r.value,c<2&&(c=0)}else 1===c&&(r=a.return)&&r.call(a),c<2&&(i=TypeError("The iterator does not provide a '"+n+"' method"),c=1);a=e}else if((r=(f=l.n<0)?i:t.call(o,l))!==s)break}catch(t){a=e,c=1,i=t}finally{u=1}}return{value:r,done:f}}}(t,a,c),!0),u}var s={};function p(){}function f(){}function l(){}r=Object.getPrototypeOf;var d=[][c]?r(r([][c]())):(o(r={},c,function(){return this}),r),h=l.prototype=p.prototype=Object.create(d);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,o(t,i,"GeneratorFunction")),t.prototype=Object.create(h),t}return f.prototype=l,o(h,"constructor",l),o(l,"constructor",f),f.displayName="GeneratorFunction",o(l,i,"GeneratorFunction"),o(h),o(h,i,"Generator"),o(h,c,function(){return this}),o(h,"toString",function(){return"[object Generator]"}),(t.exports=n=function(){return{w:u,m}},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports},163:t=>{t.exports=function(t,e){this.v=t,this.k=e},t.exports.__esModule=!0,t.exports.default=t.exports},166:(t,e,r)=>{var o=r(163),n=r(397);t.exports=function t(e,r){function a(t,n,c,i){try{var u=e[t](n),s=u.value;return s instanceof o?r.resolve(s.v).then(function(t){a("next",t,c,i)},function(t){a("throw",t,c,i)}):r.resolve(s).then(function(t){u.value=t,c(u)},function(t){return a("throw",t,c,i)})}catch(t){i(t)}}var c;this.next||(n(t.prototype),n(t.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),n(this,"_invoke",function(t,e,o){function n(){return new r(function(e,r){a(t,o,e,r)})}return c=c?c.then(n,n):n()},!0)},t.exports.__esModule=!0,t.exports.default=t.exports},183:(t,e,r)=>{var o=r(24)();t.exports=o;try{regeneratorRuntime=o}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=o:Function("r","regeneratorRuntime = r")(o)}},312:(t,e,r)=>{var o=r(110),n=r(166);t.exports=function(t,e,r,a,c){return new n(o().w(t,e,r,a),c||Promise)},t.exports.__esModule=!0,t.exports.default=t.exports},397:t=>{function e(r,o,n,a){var c=Object.defineProperty;try{c({},"",{})}catch(r){c=0}t.exports=e=function(t,r,o,n){function a(r,o){e(t,r,function(t){return this._invoke(r,o,t)})}r?c?c(t,r,{value:o,enumerable:!n,configurable:!n,writable:!n}):t[r]=o:(a("next",0),a("throw",1),a("return",2))},t.exports.__esModule=!0,t.exports.default=t.exports,e(r,o,n,a)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},735:t=>{function e(r){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},760:(t,e,r)=>{var o=r(735).default;t.exports=function(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}throw new TypeError(o(t)+" is not iterable")},t.exports.__esModule=!0,t.exports.default=t.exports},766:t=>{t.exports=function(t){var e=Object(t),r=[];for(var o in e)r.unshift(o);return function t(){for(;r.length;)if((o=r.pop())in e)return t.value=o,t.done=!1,t;return t.done=!0,t}},t.exports.__esModule=!0,t.exports.default=t.exports},996:(t,e,r)=>{var o=r(312);t.exports=function(t,e,r,n,a){var c=o(t,e,r,n,a);return c.next().then(function(t){return t.done?t.value:c.next()})},t.exports.__esModule=!0,t.exports.default=t.exports}},e={};function r(o){var n=e[o];if(void 0!==n)return n.exports;var a=e[o]={exports:{}};return t[o](a,a.exports,r),a.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var o in e)r.o(e,o)&&!r.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";const t=flarum.core.compat["forum/app"];var e=r.n(t);const o=flarum.core.compat["forum/components/DiscussionComposer"];var n=r.n(o);const a=flarum.core.compat["forum/components/ReplyComposer"];var c=r.n(a);const i=flarum.core.compat["common/extend"],u=flarum.core.compat["common/app"];var s=r.n(u),p=function(){function t(t,e,r){void 0===r&&(r=null),this.settings=t,this.callback=e,this.errorCallback=r||function(t){s().alerts.show(t)},this.widgetId=null,this.type=this.settings["fof-recaptcha.type"]}var e=t.prototype;return e.render=function(t){var e=this;this.widgetId=grecaptcha.render(t,{sitekey:this.settings["fof-recaptcha.credentials.site"],theme:Number(this.settings.theme_dark_mode)?"dark":"light",type:this.type,size:this.isInvisible()?"invisible":"normal",tabindex:this.isInvisible()?-1:null,callback:this.callback,"error-callback":function(){var t={type:"error",content:s().translator.trans("fof-recaptcha.forum.error")};e.errorCallback(t)}})},e.getResponse=function(){return grecaptcha.getResponse(this.widgetId)},e.execute=function(){return grecaptcha.execute(this.widgetId)},e.reset=function(){return grecaptcha.reset(this.widgetId)},e.isInvisible=function(){return"invisible"===this.type},t}();function f(t,e){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},f(t,e)}function l(t,e,r,o,n,a,c){try{var i=t[a](c),u=i.value}catch(t){return void r(t)}i.done?e(u):Promise.resolve(u).then(o,n)}var d=r(183),h=r.n(d);const v=flarum.core.compat["common/Component"];var y=r.n(v);const x=function(){function t(t){return function(e){return new Promise(function(r,o){var n=document.createElement(t),a="body",c="src";switch(n.onload=function(){r(e)},n.onerror=function(){o(e)},t){case"script":n.async=!0;break;case"link":n.type="text/css",n.rel="stylesheet",c="href",a="head"}n[c]=e,document[a].appendChild(n)})}}return{css:t("link"),js:t("script"),img:t("img")}}();var b=function(){var t,e=(t=h().mark(function t(){return h().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!s().recaptchaLoaded){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,x.js("https://www.recaptcha.net/recaptcha/api.js?hl="+s().translator.getLocale()+"&render=explicit");case 4:s().recaptchaLoaded=!0;case 5:case"end":return t.stop()}},t)}),function(){var e=this,r=arguments;return new Promise(function(o,n){var a=t.apply(e,r);function c(t){l(a,o,n,c,i,"next",t)}function i(t){l(a,o,n,c,i,"throw",t)}c(void 0)})});return function(){return e.apply(this,arguments)}}(),g=function(t){var e,r;function o(){return t.apply(this,arguments)||this}r=t,(e=o).prototype=Object.create(r.prototype),e.prototype.constructor=e,f(e,r);var n=o.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e)},n.view=function(){return m("div",{className:"Form-group",id:"fof-recaptcha"},m("div",{className:"g-recaptcha"}))},n.oncreate=function(e){var r=this;if(t.prototype.oncreate.call(this,e),b().then(function(){var t=setInterval(function(){window.recaptcha&&(clearInterval(t),r.attrs.state.render(e.dom.querySelector(".g-recaptcha")))},250)}),"invisible"===this.attrs.state.type){var o=e.dom.querySelector("iframe");o&&(o.tabIndex=-1)}},o}(y()),_=function(){return e().forum.attribute("fof-recaptcha.configured")&&!e().forum.attribute("postWithoutCaptcha")};function w(t){(0,i.extend)(t.prototype,"oninit",function(){var t=this;_()&&(this.recaptcha=new p(e().forum.data.attributes,function(){t.recaptcha.isInvisible()&&t.onsubmit("recaptchaSecondStep")}))}),(0,i.extend)(t.prototype,"data",function(t){_()&&(t["g-recaptcha-response"]=this.recaptcha.getResponse())}),(0,i.extend)(t.prototype,"headerItems",function(t){_()&&t.add("recaptcha",g.component({state:this.recaptcha}),-5)}),(0,i.extend)(t.prototype,"loaded",function(){_()&&this.recaptcha.reset()}),(0,i.override)(t.prototype,"onsubmit",function(t,e){return _()&&this.recaptcha.isInvisible()&&"recaptchaSecondStep"!==e?(this.loading=!0,void this.recaptcha.execute()):t()})}const S=flarum.core.compat["forum/components/ForgotPasswordModal"];var M=r.n(S);const k=flarum.core.compat["forum/components/ChangePasswordModal"];var O=r.n(k);const j=flarum.core.compat["forum/components/LogInModal"];var I=r.n(j);const P=flarum.core.compat["forum/components/SignUpModal"];var N=r.n(P),R=function(t){var r=t.modal,o=t.type,n=t.dataMethod,a=function(){return!!e().forum.attribute("fof-recaptcha."+o)};(0,i.extend)(r.prototype,"oninit",function(){var t=this;e().forum.attribute("fof-recaptcha.configured")&&a()&&(this.recaptcha=new p(e().forum.data.attributes,function(){if(t.recaptcha.isInvisible()){var e=new Event("submit");e.isRecaptchaSecondStep=!0,t.onsubmit(e)}},function(e){t.loaded(),t.alertAttrs=e}))}),(0,i.extend)(r.prototype,n,function(t){e().forum.attribute("fof-recaptcha.configured")&&a()&&(t["g-recaptcha-response"]=this.recaptcha.getResponse())}),(0,i.extend)(r.prototype,"fields",function(t){e().forum.attribute("fof-recaptcha.configured")&&a()&&t.add("recaptcha",m(g,{state:this.recaptcha}),-5)}),(0,i.extend)(r.prototype,"onerror",function(t,r){e().forum.attribute("fof-recaptcha.configured")&&a()&&(this.recaptcha.reset(),"signin"!==o||!r.alert||r.alert.content&&r.alert.content.length||(r.alert.content=e().translator.trans("fof-recaptcha.forum.unknown_error")))}),(0,i.override)(r.prototype,"onsubmit",function(t,r){return e().forum.attribute("fof-recaptcha.configured")&&a()&&this.recaptcha.isInvisible()&&!r.isRecaptchaSecondStep?(r.preventDefault(),this.loading=!0,void this.recaptcha.execute()):t(r)})};e().initializers.add("fof/recaptcha",function(){e().recaptchaLoaded=!1,w(n()),w(c()),R({modal:M(),type:"forgot",dataMethod:"requestParams"}),R({modal:O(),type:"forgot",dataMethod:"requestBody"}),R({modal:I(),type:"signin",dataMethod:"loginParams"}),R({modal:N(),type:"signup",dataMethod:"submitData"})})})(),module.exports={}})();
//# sourceMappingURL=forum.js.map